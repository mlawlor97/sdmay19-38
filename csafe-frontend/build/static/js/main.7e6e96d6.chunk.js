(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(8),o=a.n(s),i=(a(51),a(9)),l=a(10),c=a(12),p=a(11),u=a(13),d=a(2),m=a(22),h=a(19);a(53);var v=function(e){return r.a.createElement("div",{id:"search-bar"},r.a.createElement("form",{onSubmit:e.onSubmit},r.a.createElement("label",null,"Keyword:",r.a.createElement("input",{type:"text",value:e.value,onChange:e.onChange})),r.a.createElement("input",{type:"submit",value:"Submit"})))},f=a(45);var b=function(e){var t={display:"flex",alignItems:"center",justifyContent:"space-between"},a={backgroundColor:"#EBECF0",borderRadius:"2em",color:"#172B4D",display:"inline-block",fontSize:12,fontWeight:"normal",lineHeight:"1",minWidth:1,padding:"0.16666666666667em 0.5em",textAlign:"center"};return r.a.createElement("div",null,r.a.createElement(f.a,{defaultValue:e.defaultValue,onChange:e.onKeywordChange,options:e.options,formatGroupLabel:function(e){return r.a.createElement("div",{style:t},r.a.createElement("span",null,e.label),r.a.createElement("span",{style:a},e.options.length))},isClearable:!1,isSearchable:!1,isMulti:!1}))},g=(a(70),a(16)),y=a.n(g),E=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).elements={},a.register=function(e,t){a.elements[e]=t},a.unregister=function(e){delete a.elements[e]},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getChildContext",value:function(){return{scroll:{register:this.register,unregister:this.unregister}}}},{key:"render",value:function(){return r.a.Children.only(this.props.children)}}]),t}(n.Component);E.childContextTypes={scroll:y.a.object};var _=E,k=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.context.scroll.register(this.props.name,this._element)}},{key:"componentWillUnmount",value:function(){this.context.scroll.unregister(this.props.name)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{onClick:this.props.onClick},r.a.cloneElement(this.props.children,{ref:function(t){return e._element=t}}))}}]),t}(n.Component);k.contextTypes={scroll:y.a.object};var w=k,C=[{label:"Keywords",options:[{value:"appName",label:"App Name",group:"Keywords"},{value:"packageName",label:"Package Name",group:"Keywords"}]}];var S=function(e){var t=[],a={label:"Versions"},n=e.map(function(e){return{value:e.version,label:e.version,group:"Versions"}});return a.options=n,t.push(a),t},j=a(41),O=a.n(j),N=a(74),A=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={keyword:"",keywordFilter:"appName",versions:[],response:[],newData:[],displayVersion:[],evidenceData:[],refresh:!0,stats:"",responseVersions:[]},a.onKeywordChange=a.onKeywordChange.bind(Object(d.a)(Object(d.a)(a))),a.onSubmit=a.onSubmit.bind(Object(d.a)(Object(d.a)(a))),a.handleKeywordTypeChange=a.handleKeywordTypeChange.bind(Object(d.a)(Object(d.a)(a))),a.onAppClick=a.onAppClick.bind(Object(d.a)(Object(d.a)(a))),a.handleVersionChange=a.handleVersionChange.bind(Object(d.a)(Object(d.a)(a))),a.handleFiles=a.handleFiles.bind(Object(d.a)(Object(d.a)(a))),a.grabStats=a.grabStats.bind(Object(d.a)(Object(d.a)(a))),a.downloadAPK=a.downloadAPK.bind(Object(d.a)(Object(d.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"downloadAPK",value:function(){var e=this,t="";this.state.responseVersions.forEach(function(a){a.version===e.state.displayVersion[0].version&&(t=a._id)}),setTimeout(function(){var e={file:"http://35.194.33.104:3000/api/v1/download/"+t};window.open(e.file)},100)}},{key:"grabStats",value:function(){var e=this;N.get("http://35.194.33.104:3000/api/v1/stats").then(function(t){var a=r.a.createElement("div",{className:"stats"},r.a.createElement("ul",null,r.a.createElement("b",null,"applications")," ",": "+t.data.applications),r.a.createElement("ul",null,r.a.createElement("b",null,"versions")," ",": "+t.data.versions),r.a.createElement("ul",null,r.a.createElement("b",null,"Store")," ",": "+t.data.stores[0]._id,r.a.createElement("br",null),r.a.createElement("b",null,"Number of Apps")," ",": "+t.data.stores[0].count),r.a.createElement("ul",null,r.a.createElement("b",null,"Store")," ",": "+t.data.stores[1]._id,r.a.createElement("br",null),r.a.createElement("b",null,"Number of Apps")," ",": "+t.data.stores[1].count));e.setState({stats:a})}).catch(function(e){console.log(e)})}},{key:"handleFiles",value:function(e){var t=this,a=new FileReader;a.onload=function(e){for(var n=a.result.split(","),r=[],s=0;s<n.length;s+=3){var o={packageName:n[s],appStore:n[s+1],appVersion:n[s+2]};r.push(o)}N.post("http://35.194.33.104:3000/api/v1/applications/",{appData:r}).then(function(e){var a=[];e.data.forEach(function(e){var t={app_id:e._id,store_id:e.store_id,app_name:e.app_name,Developer:e.metadata.developer,Package:e.metadata.package,Category:e.metadata.category,url:e.app_url};e.versions&&(t.Version=e.versions[0].version),a.push(t)}),t.setState({response:a})}).catch(function(e){console.log("error"),console.log(e)})},a.readAsText(e[0])}},{key:"onKeywordChange",value:function(e){this.setState({keyword:e.target.value})}},{key:"handleKeywordTypeChange",value:function(e){this.setState({keywordFilter:e.value})}},{key:"handleVersionChange",value:function(e){var t=this.state.newData.filter(function(t){return t.version===e.value});this.setState({displayVersion:t})}},{key:"onAppClick",value:function(e){var t=this;this.setState({newData:[]}),this.setState({displayVersion:[]}),this.setState({versions:[]}),this.setState({evidenceData:[]});var a=[];N.get("http://35.194.33.104:3000/api/v1/applications/"+e).then(function(e){t.setState({responseVersions:e.data[0].versions});var n=e.data[0],r={store_id:n.store_id,app_name:n.app_name,Developer:n.metadata.developer,Package:n.metadata.package,Category:n.metadata.category,url:n.app_url};if(a.push(r),n.versions.forEach(function(e){var t={store_id:e.store_id,app_name:e.app_name,version:e.version,apk_type:e.metadata.apk_type,file_size:e.metadata.file_size,requirements:e.metadata.requirements,publish_date:e.metadata.publish_date,patch_notes:e.metadata.patch_notes,signature:e.metadata.signature,sha1:e.metadata.sha1};void 0!==e.metadata.permissions&&e.metadata.permissions.forEach(function(e){t.permissions+="\n"+e}),void 0===e.metadata.apk_type&&(t.apk_type="APK"),a.push(t)}),0!==n.versions[0].report.length){var s=[],o=n.versions[0].report,i=[],l=[];o[0].report.app_evidence[1].file_system.length&&o[0].report.app_evidence[1].file_system.forEach(function(e){var t={path:e.path,evidence_types:e.evidence_types};i.push(t)}),o[0].report.app_evidence[2].network.length&&o[0].report.app_evidence[2].network.forEach(function(e){var t={path:e.path,evidence_types:e.evidence_types};l.push(t)}),i.forEach(function(e,t){var a={app_package_name:n.metadata.package,version:o.version};i[t]&&(a["file path"]=i[t].path,a["file evidence types"]=i[t].evidence_types.toString()),l[t]&&(a["network address"]=i[t].path,a["network evidence types"]=i[t].evidence_types.toString()),s.push(a)}),t.setState({evidenceData:s})}else t.setState({evidenceData:[]});var c=[];c.push(a[1]),t.setState({versions:S(n.versions)}),t.setState({newData:a}),t.setState({displayVersion:c})}).catch(function(e){console.log(e)})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),"appName"===this.state.keywordFilter?N.get("http://35.194.33.104:3000/api/v1/applications",{params:{appName:this.state.keyword}}).then(function(e){var a=[];e.data.forEach(function(e){var t={app_id:e._id,store_id:e.store_id,app_name:e.app_name,Developer:e.metadata.developer,Package:e.metadata.package,Category:e.metadata.category,url:e.app_url};e.versions&&(t.Version=e.versions[0].version),a.push(t)}),t.setState({response:a}),t.setState({refresh:!1})}).catch(function(e){t.setState({response:[]})}):"packageName"===this.state.keywordFilter&&N.get("http://35.194.33.104:3000/api/v1/applications",{params:{packageName:this.state.keyword}}).then(function(e){var a=[];e.data.forEach(function(e){var t={app_id:e._id,store_id:e.store_id,app_name:e.app_name,Developer:e.metadata.developer,Package:e.metadata.package,Category:e.metadata.category,url:e.app_url};e.versions&&(t.Version=e.versions[0].version),a.push(t)}),t.setState({response:a}),t.setState({refresh:!1})}).catch(function(e){t.setState({response:[]})})}},{key:"componentWillMount",value:function(){this.grabStats()}},{key:"render",value:function(){var e=this,t=r.a.createElement(_,{ref:function(t){return e._scroller=t}},r.a.createElement("div",{className:"scroller"},this.state.response.map(function(t){var a=t.app_name,n=t.Developer,s=t.Package,o=t.Category,i=t.url,l=t.app_id,c=t.store_id;return r.a.createElement(w,{name:a},r.a.createElement("div",{className:"item",onClick:function(){return e.onAppClick(l)}},r.a.createElement(m.b,{className:"routeLink",to:"/app/".concat(l)},r.a.createElement("ul",null,r.a.createElement("b",null,"App Name"),": "+a),r.a.createElement("ul",null,r.a.createElement("b",null,"Developer"),": "+n),r.a.createElement("ul",null,r.a.createElement("b",null,"Package"),": "+s),r.a.createElement("ul",null,r.a.createElement("b",null,"Store"),": "+c," "),r.a.createElement("ul",null,r.a.createElement("b",null,"Category"),": "+o)),r.a.createElement("ul",null,r.a.createElement("b",null,"URL: "),r.a.createElement("a",{href:i},i))))}))),a=r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"gridwrapper"},r.a.createElement("div",{className:"menu"},r.a.createElement("h1",{id:"header"},"Forensic Android App Database"),r.a.createElement("div",{className:"searchbar"},r.a.createElement(v,{onSubmit:this.onSubmit,value:this.state.keyword,onChange:this.onKeywordChange})),r.a.createElement("div",{className:"filereader"},r.a.createElement(O.a,{handleFiles:this.handleFiles,fileTypes:[".csv",".txt"]},r.a.createElement("button",{className:"btn"},"Upload"))),r.a.createElement("div",{className:"dropdown"},r.a.createElement(b,{onKeywordChange:this.handleKeywordTypeChange,options:C,defaultValue:C[0].options[0]}))),this.state.refresh?this.state.stats:t)),n=r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"gridwrapperInfo"},r.a.createElement("div",{className:"menu"},r.a.createElement("h1",{id:"header"},"Forensic Android App Database"),r.a.createElement("button",{onClick:this.downloadAPK},"Download APK"),r.a.createElement(b,{onKeywordChange:this.handleVersionChange,options:this.state.versions,defaultValue:this.state.versions[0]})),r.a.createElement("div",{className:"scrollerInfo"},r.a.createElement(_,{ref:function(t){return e._scroller=t}},r.a.createElement("div",{id:"left"},this.state.displayVersion.map(function(e){return r.a.createElement(w,{name:e.app_name},r.a.createElement("div",{className:"itemInfo"},Object.keys(e).map(function(t){return r.a.createElement("ul",null,r.a.createElement("b",null,t)," ",": "+e[t])})))}))),r.a.createElement(_,{ref:function(t){return e._scroller=t}},r.a.createElement("div",{id:"right"},this.state.evidenceData.map(function(e){return r.a.createElement(w,{name:e.app_name},r.a.createElement("div",{className:"itemInfo"},Object.keys(e).map(function(t){return r.a.createElement("ul",null,r.a.createElement("b",null,t)," ",": "+e[t])})))}))))));return r.a.createElement(m.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(h.a,{exact:!0,path:"/",render:function(){return a}}),r.a.createElement(h.a,{path:"/app/:app_id",render:function(){return n}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},46:function(e,t,a){e.exports=a(104)},51:function(e,t,a){},53:function(e,t,a){}},[[46,2,1]]]);
//# sourceMappingURL=main.7e6e96d6.chunk.js.map